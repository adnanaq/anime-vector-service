# STATISTICS EXTRACTION STAGE
Extract ONLY statistics from multiple data sources with proper normalization and standardization.

# INPUT DATA
## JIKAN DATA:
{jikan_data}

## ANIMESCHEDULE DATA:
{animeschedule_data}

## KITSU DATA:
{kitsu_data}

## ANIME-PLANET DATA:
{animeplanet_data}

## ANILIST DATA:
{anilist_data}

## ANIDB DATA:
{anidb_data}


# PROCESSING INSTRUCTIONS

## STATISTICS EXTRACTION
Extract statistics from ALL available data sources with standardized StatisticsEntry format:

### SOURCE-SPECIFIC MAPPINGS:
- **JIKAN (MAL)**: 
  - score → score (already 0-10 scale)
  - scored_by → scored_by
  - rank → rank
  - popularity → popularity_rank
  - members → members
  - favorites → favorites

- **ANIMESCHEDULE**:
  - averageScore → score (normalized to 0-10 scale)
  - ratingCount → scored_by
  - trackedCount → members
  - trackedRating → rank

- **KITSU**:
  - averageRating → score (÷10 for 0-10 scale, e.g., "82.14" → 8.214)
  - userCount → members
  - favoritesCount → favorites
  - popularityRank → popularity_rank
  - ratingRank → rank

- **ANIME-PLANET**:
  - json_ld.aggregateRating.ratingValue → score (×2 for 0-10 scale, e.g., 4.355 → 8.71)
  - json_ld.aggregateRating.ratingCount → scored_by
  - rank → rank (if available)

- **ANILIST**:
  - averageScore → score (÷10 for 0-10 scale, e.g., 86 → 8.6)
  - favourites → favorites
  - popularity → popularity_rank
  - rankings → contextual_ranks (extract array of ranking objects with rank, type, format, year, season, all_time)

- **ANIDB**:
  - ratings.permanent.value → score (already 0-10 scale)
  - ratings.permanent.count → scored_by

## STATISTICS NORMALIZATION RULES:
- **Score Normalization**: All scores must be normalized to 0-10 scale as floats
- **Missing Fields**: Use null for unavailable fields (don't omit entirely)
- **Source Attribution**: Each source gets its own statistics object
- **Standard Properties**: All sources use same property names: score, scored_by, rank, popularity_rank, members, favorites


# OUTPUT SCHEMA
Return ONLY statistics in JSON format:
**CRITICAL: Statistics must be ordered exactly as shown below to match StatisticsEntry schema requirements.**

{
    "statistics": {
        "anidb": {
            "score": 8.74,
            "scored_by": 18699,
            "rank": null,
            "popularity_rank": null,
            "members": null,
            "favorites": null,
            "contextual_ranks": null
        },
        "anilist": {
            "score": 8.6,
            "scored_by": null,
            "rank": null,
            "popularity_rank": 50,
            "members": null,
            "favorites": 18500,
            "contextual_ranks": [
                {
                    "rank": 1,
                    "type": "POPULAR",
                    "format": "TV",
                    "year": 2021,
                    "season": "FALL",
                    "all_time": false
                }
            ]
        },
        "animeplanet": {
            "score": 8.71,
            "scored_by": 8500,
            "rank": 78,
            "popularity_rank": null,
            "members": null,
            "favorites": null,
            "contextual_ranks": null
        },
        "animeschedule": {
            "score": 8.5,
            "scored_by": 1200,
            "rank": 45,
            "popularity_rank": null,
            "members": 5000,
            "favorites": null,
            "contextual_ranks": null
        },
        "kitsu": {
            "score": 8.214,
            "scored_by": null,
            "rank": 67,
            "popularity_rank": 120,
            "members": 15000,
            "favorites": 2500,
            "contextual_ranks": null
        },
        "mal": {
            "score": 8.11,
            "scored_by": 916846,
            "rank": 530,
            "popularity_rank": 85,  
            "members": 1524895,
            "favorites": 26442,
            "contextual_ranks": null
        }
    }
}

**CRITICAL REQUIREMENTS**:
- Handle missing fields gracefully (use null, don't omit fields)
- Maintain source attribution and separation
- Apply appropriate score normalization per source
- Use only the standardized property names across all sources
- Extract statistics from ALL available sources that have data
- Omit source objects entirely if no statistical data is available from that source

**IMPORTANT**: Your response must be ONLY valid JSON. Do not include any text before or after the JSON. Do not explain your process. Return only the JSON object with the exact schema above.